package wtf.demise.features.modules.impl.exploit;

import net.minecraft.network.play.client.C03PacketPlayer;
import wtf.demise.events.annotations.EventTarget;
import wtf.demise.events.impl.player.MotionEvent;
import wtf.demise.features.modules.Module;
import wtf.demise.features.modules.ModuleInfo;
import wtf.demise.features.values.impl.ModeValue;
import wtf.demise.features.values.impl.SliderValue;
import wtf.demise.utils.packet.PacketUtils;

@ModuleInfo(name = "Regen", description = "Allows you to regenerate your health faster.")
public class Regen extends Module {

    private final ModeValue mode = new ModeValue("Mode", new String[]{"Vanilla", "Verus"}, "Vanilla", this);
    private final SliderValue health = new SliderValue("Health", 15, 1, 20, 1, this);
    private final SliderValue speed = new SliderValue("Speed", 20, 1, 300, 1, this, () -> mode.is("Vanilla"));
    private final SliderValue tick = new SliderValue("Delay (ticks)", 1, 1, 20, 1, this, () -> mode.is("Vanilla"));

    @EventTarget
    public void onPreMotion(MotionEvent e) {
        if (e.isPre()) {
            switch (mode.get()) {
                case "Vanilla":
                    if (mc.thePlayer.ticksExisted > 10 && mc.thePlayer.getHealth() < health.get() && mc.thePlayer.ticksExisted % tick.get() == 0) {
                        for (int i = 0; i < speed.get(); i++) {
                            PacketUtils.sendPacket(new C03PacketPlayer());
                        }
                    }
                    break;
                case "Verus":
                    if (mc.thePlayer.getHealth() < health.get()) {
                        for (int i = 0; i < 30; i++) {
                            if (mc.thePlayer.onGround) {
                                PacketUtils.sendPacketNoEvent(new C03PacketPlayer.C04PacketPlayerPosition(mc.thePlayer.posX, mc.thePlayer.posY, mc.thePlayer.posZ, true));
                            }
                        }
                    }
                    break;
            }
        }
    }
}